@model MealSocialServerMVC.Models.CreatePostViewModel

@{
    ViewData["Title"] = "Create Post";
}

@if (ViewBag.Message != null)
{
        <div style="background-color: #28a745; padding: 10px; border-radius: 6px; margin-bottom: 15px; color: white; font-weight: bold;">
        @ViewBag.Message
        </div>
}

@if (!ViewData.ModelState.IsValid)
{
        <div style="background-color: #dc3545; padding: 10px; border-radius: 6px; margin-bottom: 15px; color: white; font-weight: bold;">
        @foreach (var modelError in ViewData.ModelState.Values.SelectMany(v => v.Errors))
        {
                    <div>@modelError.ErrorMessage</div>
        }
        </div>
}

<form asp-action="Create" method="post" style="background-color: #2f333a; padding: 30px; border-radius: 15px; max-width: 800px; margin: auto; color: white; font-family: sans-serif;">
    <h2 style="color: #00ADB5;">Post Title</h2>
    <input asp-for="Title" placeholder="Enter your post title..." maxlength="50" class="form-control"
           style="background-color: #d9d9d9; border-radius: 6px; border: none; padding: 10px; width: 100%;" />
    <small id="titleCharCount" style="float: right; color: gray;">0/50</small>
    <span asp-validation-for="Title" class="text-danger"></span>

    <h2 style="color: #00ADB5; margin-top: 20px;">Description</h2>
    <textarea asp-for="Content" placeholder="Write your post description..." maxlength="250"
              rows="6" class="form-control"
              style="background-color: #d9d9d9; border-radius: 6px; border: none; padding: 10px; width: 100%;"></textarea>
    <small id="descCharCount" style="float: right; color: gray;">0/250</small>
    <span asp-validation-for="Content" class="text-danger"></span>

    <h2 style="color: #00ADB5; margin-top: 20px;">Visibility</h2>
    <select asp-for="Visibility" class="form-control"
            style="background-color: #d9d9d9; border-radius: 6px; padding: 10px;">
        <option value="1">Private</option>
        <option value="2">Friends</option>
        <option value="3">Public</option>
        <option value="4">Groups</option>
    </select>
    <span asp-validation-for="Visibility" class="text-danger"></span>

    <h2 style="color: #00ADB5; margin-top: 20px;">Tags</h2>
    <div style="display: flex; gap: 12px; margin-top: 10px;">
        <label style="background-color: #d9d9d9; border-radius: 6px; padding: 10px 16px;">
            <input type="radio" asp-for="Tag" value="3" /> Misc
        </label>
        <label style="background-color: #d9d9d9; border-radius: 6px; padding: 10px 16px;">
            <input type="radio" asp-for="Tag" value="1" /> Food
        </label>
        <label style="background-color: #d9d9d9; border-radius: 6px; padding: 10px 16px;">
            <input type="radio" asp-for="Tag" value="2" /> Workout
        </label>
        <label style="background-color: #d9d9d9; border-radius: 6px; padding: 10px 16px;">
            <input type="radio" asp-for="Tag" value="4" /> Blessed
        </label>
    </div>
    <span asp-validation-for="Tag" class="text-danger"></span>

    <div style="margin-top: 30px; display: flex; justify-content: flex-end; gap: 12px;">
        <a href="/posts" class="btn btn-secondary" style="border-radius: 6px;">Cancel</a>
        <button type="submit" class="btn" style="background-color: #00ADB5; color: white; border-radius: 6px;">Post</button>
    </div>
</form>

@section Scripts {
        <partial name="_ValidationScriptsPartial" />
        <script>
            const titleInput = document.querySelector('[name="Title"]');
            const descInput = document.querySelector('[name="Content"]');
            const titleCounter = document.getElementById('titleCharCount');
            const descCounter = document.getElementById('descCharCount');

            titleInput.addEventListener('input', () => {
                titleCounter.textContent = `${titleInput.value.length}/50`;
            });

            descInput.addEventListener('input', () => {
                descCounter.textContent = `${descInput.value.length}/250`;
            });
        </script>
}
